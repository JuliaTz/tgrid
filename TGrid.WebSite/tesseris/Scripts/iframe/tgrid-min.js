function isNull(n){return n==null}function isNotNull(n){return n!=null}function isUndefined(n){return typeof n=="undefined"}function isNotUndefined(n){return typeof n!="undefined"}function isNoU(n){return isUndefined(n)||isNull(n)}function isNotNoU(n){return isNotUndefined(n)&&isNotNull(n)}function isFunction(n){return n&&{}.toString.call(n)==="[object Function]"}function isObservable(n){return n&&{}.toString.call(n)==="[object Function]"}function insertAfter(n,t){var i=n.parentNode,r=n.nextSibling;return r?i.insertBefore(t,r):i.appendChild(t)}function insertBefore(n,t){var i=n.parentNode;return i.insertBefore(t,n)}function getMemberValue(n,t){if(t==null||t.length==0)return n;for(var i=t.split("."),r=n;i.length>0;)r=r[i[0]],i.splice(0,1);return r}function hideElement(n){n.style.display="none"}function unhideElement(n){n.style.display=""}var TesserisPro;(function(n){(function(t){var i=function(){function i(){}return i.prototype.getTableElement=function(){var n=document.createElement("table");return n.className="tgrid-table",n},i.prototype.bindData=function(){},i.prototype.getElemntsSize=function(){return 0},i.prototype.getFirstVisibleItem=function(){return null},i.prototype.getVisibleitemsCount=function(n,t,i,r){for(var f,e=0,o=0,s=n.children,h=0,u=0;u<s.length;u++)if(f=s.item(u),e+=f.clientHeight,e>r&&(o++,h+=f.clientHeight),h>=t.clientHeight)break;return o-1},i.prototype.getFooterViewModel=function(){},i.prototype.getFilterPopupViewModel=function(){},i.prototype.updateTableHeadElement=function(){},i.prototype.updateTableBodyElement=function(){},i.prototype.updateTableFooterElement=function(){},i.prototype.updateGroupedTableBodyElement=function(){},i.prototype.updateColumnWidth=function(n,t,i){for(var r,f,s=t.getElementsByTagName("th"),e=i.getElementsByTagName("tr"),o,u=0;u<e.length;u++)if(e.item(u).classList.contains("table-body-row")){o=e.item(u);break}for(r=0;r<n.columns.length&&n.columns[r].device.indexOf("desktop")==-1;)r++;for(u=0;u<s.length-1;u++){while(r<n.columns.length&&n.columns[r].device.indexOf("desktop")==-1)r++;if(r>=n.columns.length){r=n.columns.length-1;break}s.item(u+n.columns.length).setAttribute("width",n.columns[r].width);r++}for(r=0;r<n.columns.length&&n.columns[r].device.indexOf("desktop")==-1;)r++;if(o!=undefined)for(f=o.getElementsByTagName("td"),u=0;u<f.length-1;u++)if(!f.item(u).classList.contains("tgrid-table-indent-cell")){while(r<n.columns.length&&n.columns[r].device.indexOf("desktop")==-1)r++;if(r>=n.columns.length){r=n.columns.length-1;break}f.item(u).setAttribute("width",n.columns[r].width);r++}},i.prototype.buildDefaultTableFooterElement=function(n,t,i){var e=n.currentPage-n.pageSlide,u,o,f,s,r;for(e<0&&(e=0),u=n.currentPage+n.pageSlide,o=Math.ceil(i/n.pageSize),u>=o&&(u=o-1),f=document.createElement("div"),f.setAttribute("class","tgird-pagination"),e>0&&(f.innerHTML+="<span class='tgird-page-number' onclick='TesserisPro.TGrid.Grid.getGridObject(event.target).selectPage("+(e-1).toString()+")' >...<\/span>"),r=e;r<=u;r++)f.innerHTML+=n.currentPage==r?"<span class='tgird-page-current'>"+(r+1)+"<\/span>":"<span class='tgird-page-number' onclick='TesserisPro.TGrid.Grid.getGridObject(event.target).selectPage("+r+")' >"+(r+1)+"<\/span>";for(u<o-1&&(f.innerHTML+="<span class='tgird-page-number' onclick='TesserisPro.TGrid.Grid.getGridObject(event.target).selectPage("+u.toString()+")' >...<\/span>"),s=t.getElementsByClassName("tgird-pagination"),r=0;r<s.length;r++)t.removeChild(s[r]);t.appendChild(f)},i.prototype.getActualDetailsTemplate=function(n){return n.showDetailFor.item==null?null:n.showDetailFor.column==-1?n.detailsTemplateHtml:n.columns[n.showDetailFor.column].cellDetail},i.prototype.updateTableDetailRow=function(){},i.prototype.updateMobileDetailRow=function(){},i.prototype.buildDefaultHeader=function(n,t){var i=document.createElement("span"),r=document.createTextNode(t);i.appendChild(r);n.appendChild(i)},i.prototype.updateGroupByPanel=function(n,t){var r,i,u;t.innerHTML="";n.enableGrouping&&(this.addActualGroupByElements(n,t),r=document.createElement("div"),r.setAttribute("class","tgrid-goup-button"),i=document.createElement("ul"),i.setAttribute("class","tgrid-menu"),hideElement(i),u=this,r.onclick=function(t){t.cancelBubble=!0;u.updateGroupByMenuContent(n,i);unhideElement(i);u.doOnClickOutside(i,function(){return hideElement(i)})},r.appendChild(i),t.appendChild(r))},i.prototype.showNeededIndents=function(n,t){for(var u=t,r=n.getElementsByClassName("tgrid-table-indent-cell"),i=0;i<r.length;i++)hideElement(r[i]);for(r.length<t&&(u=r.length),i=0;i<u;i++)unhideElement(r[i])},i.prototype.updateFilteringPopUp=function(){},i.prototype.buildDefaultFiltringPopUp=function(n,i){var o=document.createElement("select"),r=document.createElement("option"),u,f,e;r.value=t.FilterCondition.None.toString();r.text="None";o.appendChild(r);r=document.createElement("option");r.value=t.FilterCondition.Equals.toString();r.text="Equals";o.appendChild(r);r=document.createElement("option");r.value=t.FilterCondition.NotEquals.toString();r.text="Not equals";o.appendChild(r);i.appendChild(o);o.selectedIndex=1;u=document.createElement("input");u.type="text";u.className="tgrid-filter-input-text";u.setAttribute("value","");u.style.width="150px";i.appendChild(u);i.innerHTML+="<br>";f=document.createElement("div");f.className="tgrid-filter-popup-button";f.style.width="70px";f.onclick=function(n){var i=t.Grid.getGridObject(n.target);i.filterPopupViewModel.onApply()};f.innerHTML="OK";i.appendChild(f);e=document.createElement("div");e.className="tgrid-filter-popup-button";e.style.width="70px";e.onclick=function(n){var i=t.Grid.getGridObject(n.target);i.filterPopupViewModel.onClose();u.setAttribute("value","")};e.innerHTML="Cancel";i.appendChild(e)},i.prototype.addActualGroupByElements=function(n,i){for(var f,e,r,h,s,o,u=0;u<n.groupBySortDescriptors.length;u++)for(f=0;f<n.columns.length;f++)n.columns[f].device.indexOf("desktop")!=-1&&(e=n.columns[f],e.groupMemberPath==n.groupBySortDescriptors[u].path&&e.groupMemberPath!=null&&(r=document.createElement("div"),h=this.buildColumnHeader(e),this.bindData(n,h),r.className="tgrid-group-by-element",r["data-group-by"]=e.groupMemberPath,r.appendChild(h),s=document.createElement("div"),s.className="tgrid-header-cell-buttons",o=document.createElement("div"),o.className="tgrid-delete-button",o["data-delete-group-by"]=n.groupBySortDescriptors[u],o.onclick=function(n){n.cancelBubble=!0;t.Grid.getGridObject(n.target).removeGroupDescriptor(n.target["data-delete-group-by"].path)},s.appendChild(o),r.appendChild(s),i.appendChild(r)))},i.prototype.updateGroupByMenuContent=function(n,i){var r,e,f,u,o;for(i.innerHTML="",r=0;r<n.columns.length;r++)if(n.columns[r].device.indexOf("desktop")!=-1&&n.columns[r].groupMemberPath!=null){for(e=!1,f=0;f<n.groupBySortDescriptors.length;f++)n.groupBySortDescriptors[f].path==n.columns[r].groupMemberPath&&(e=!0);e||(u=document.createElement("li"),u["data-group-by-path"]=n.columns[r].groupMemberPath,o=this.buildColumnHeader(n.columns[r]),this.bindData(n,o),u.appendChild(o),u.onclick=function(n){hideElement(i);t.Grid.getGridObject(n.target).addGroupDescriptor(n.currentTarget["data-group-by-path"],!0)},i.appendChild(u))}},i.prototype.createDefaultMobileTemplate=function(n,t){for(var u,f,r,e,i=0;i<t.columns.length;i++)t.columns[i].device.indexOf("mobile")!=-1&&(u=document.createElement("div"),f=document.createElement("span"),f.innerHTML=t.columns[i].member!=null?t.columns[i].member:t.columns[i].sortMemberPath!=null?t.columns[i].sortMemberPath:t.columns[i].groupMemberPath!=null?t.columns[i].groupMemberPath:"",r=document.createElement("span"),t.columns[i].member!=null?(e=document.createElement("span"),e.setAttribute("data-bind","text: item.".concat(t.columns[i].member)),r.innerHTML=": ",r.appendChild(e)):r.innerHTML=": ",u.appendChild(f),u.appendChild(r),n.appendChild(u));return n},i.prototype.buildGroupMobileHeaderRow=function(t,i){var r=document.createElement("div"),u=document.createElement("div"),f;for(r.classList.add("tgrid-mobile-group-header"),f=0;f<i.level;f++)r.innerHTML+="<div class='tgrid-mobile-group-indent-div'><\/div>";return t.enableCollapsing&&(r.onclick=i.collapse?function(t){n.TGrid.Grid.getGridObject(t.target).removeCollapsedFilters(i.filterDescriptor)}:function(t){n.TGrid.Grid.getGridObject(t.target).setCollapsedFilters(i.filterDescriptor)}),t.groupHeaderTemplate!=null?t.groupHeaderTemplate.applyTemplate(u):this.createDefaultGroupHeader(u),u.classList.add("tgrid-mobile-group-header-container"),this.bindMobileGroupHeader(r,i.value,u),r},i.prototype.bindMobileGroupHeader=function(n,t,i){n.appendChild(i)},i.prototype.createDefaultGroupHeader=function(){},i.prototype.addFilterButton=function(n,i,r,u,f){var e,o;n.enableFiltering&&(e=document.createElement("div"),e.classList.add("tgrid-filter-button"),o=this,function(i){e.onclick=function(u){t.Grid.getGridObject(u.target).showFilterPopup(n.columns[i],u.pageX,u.pageY,!0);o.doOnClickOutside(r,function(){return t.Grid.getGridObject(u.target).hideFilterPopup()});u.cancelBubble=!0}}(f),u.appendChild(e))},i.prototype.updateMobileHeadElement=function(n,t,i){t.innerHTML="";(n.enableSorting||n.enableGrouping||n.enableFiltering)&&this.createMobileButton(n,t,i)},i.prototype.updateMobileItemsList=function(){},i.prototype.createMobileButton=function(n,t,i){var f=this,r=document.createElement("div"),u;r.className=this.anyConditionIsApplied(n)?"tgrid-mobile-button-active":"tgrid-mobile-button";u=this;r.onclick=function(t){var e=document.createElement("ul");e.className="tgrid-mobile-menu";f.addMobileMenuItems(n,e,i);r.innerHTML="";r.appendChild(e);u.doOnClickOutside(e,function(){hideElement(e)});t.cancelBubble=!0};t.appendChild(r)},i.prototype.addMobileMenuItems=function(n,i,r){for(var u,l,v,a,e,h,o,y,w,s,p,f,c=0;c<n.columns.length;c++)if(u=n.columns[c],u.member!=null||u.sortMemberPath!=null||u.filterMemberPath!=null||u.groupMemberPath!=null){if(l=document.createElement("li"),v=this.buildMobileMenuColumnHeader(u),this.bindData(n,v),a=document.createElement("div"),a.className="tgrid-mobile-li-header-container",a.appendChild(v),e=document.createElement("div"),e.className="tgrid-header-cell-buttons",n.enableSorting&&u.sortMemberPath!=null&&(h=document.createElement("div"),h.className=u.sortMemberPath==n.sortDescriptor.path?n.sortDescriptor.asc==null?"tgrid-sort-button":n.sortDescriptor.asc?"tgrid-sort-button-asc":"tgrid-sort-button-desc":"tgrid-sort-button",e.appendChild(h),h["data-g-path"]=u.sortMemberPath,h.onclick=function(n){n.cancelBubble=!0;hideElement(i);t.Grid.getGridObject(n.target).sortBy(n.target["data-g-path"])}),n.enableFiltering&&u.filterMemberPath!=null){for(o=document.createElement("div"),y=!1,f=0;f<n.filterDescriptors.length;f++)if(n.filterDescriptors[f].path==u.filterMemberPath){o.className="tgrid-mobile-filter-button-active";y=!0;break}y||(o.className="tgrid-mobile-filter-button");e.appendChild(o);o["data-g-column"]=u;w=this;o.onclick=function(n){n.cancelBubble=!0;hideElement(i);w.doOnClickOutside(r,function(){hideElement(r)});t.Grid.getGridObject(n.target).showFilterPopup(n.target["data-g-column"],n.pageX,n.pageY,!1)}}if(n.enableGrouping&&u.groupMemberPath!=null){for(s=document.createElement("div"),p=!1,f=0;f<n.groupBySortDescriptors.length;f++)if(n.groupBySortDescriptors[f].path==u.groupMemberPath){s.className="tgrid-group-button-active";p=!0;break}p||(s.className="tgrid-group-button");e.appendChild(s);s["data-g-path"]=u.groupMemberPath;s.onclick=function(n){n.cancelBubble=!0;hideElement(i);var r=t.Grid.getGridObject(n.target);r.toggleGroupDescriptor(n.target["data-g-path"])}}l.appendChild(a);l.appendChild(e);i.appendChild(l)}},i.prototype.doOnClickOutside=function(n,t){var i=document.onclick;document.onclick=function(r){for(var u=r.target;u.tagName!="BODY";){if(u==n)return;u=u.parentElement}document.onclick=i;t()}},i.prototype.buildColumnHeader=function(n){var t=document.createElement("div"),i;return t.className="tgrid-header-cell-content",n.header!=null?n.header.applyTemplate(t):(i=n.member!=null?n.member:"",this.buildDefaultHeader(t,i)),t},i.prototype.buildMobileMenuColumnHeader=function(n){var t=document.createElement("div"),i;return t.className="tgrid-mobile-menu-li-column-header",n.header!=null?n.header.applyTemplate(t):(i=n.member!=null?n.member:"",this.buildDefaultHeader(t,i)),t},i.prototype.anyConditionIsApplied=function(n){return n.sortDescriptor.path!=null||n.groupBySortDescriptors.length>0&&n.groupBySortDescriptors[0].path!=null||n.filterDescriptors.length>0?!0:!1},i}();t.BaseHtmlProvider=i})(n.TGrid||(n.TGrid={}));var t=n.TGrid})(TesserisPro||(TesserisPro={})),function(n){(function(n){var t=function(){function t(t,i,r,u,f){this.path=t;this.value=i;this.condition=r;this.children=f!=undefined?f:[];this.operation=u!=undefined?u:n.FilterOperation.And}return t}();n.FilterDescriptor=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={})),function(n){(function(n){var t=function(){function n(n,t,i,r){this.collapse=i;this.value=n;this.level=t;this.filterDescriptor=r}return n}();n.GroupHeaderDescriptor=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={})),function(n){(function(n){var t=function(){function n(n,t,i,r){this.model=n;this.item=t;this.grid=i;this.isGroupHeader=r}return n.prototype.showDetailForCell=function(n){this.grid.options.showDetailFor.column=n;this.grid.options.showDetailFor.isDetailColumn=!0;this.grid.options.showDetailFor.item=this.item;this.grid.updateRow(this.item)},n}();n.ItemViewModel=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={})),function(n){(function(t){var e,o,s,h,r,u,i,f;(function(n){n[n.Knockout=0]="Knockout";n[n.Angular=1]="Angular"})(t.Framework||(t.Framework={}));e=t.Framework,function(n){n[n.None=0]="None";n[n.Single=1]="Single";n[n.Multi=2]="Multi"}(t.SelectionMode||(t.SelectionMode={}));o=t.SelectionMode,function(n){n[n.None=0]="None";n[n.Equals=1]="Equals";n[n.NotEquals=2]="NotEquals"}(t.FilterCondition||(t.FilterCondition={}));s=t.FilterCondition,function(n){n[n.And=0]="And";n[n.Or=1]="Or"}(t.FilterOperation||(t.FilterOperation={}));h=t.FilterOperation;r=function(){function n(){}return n}();t.ColumnInfo=r;u=function(){function n(){this.column=-1;this.item=null;this.isDetailColumn=!1}return n}();t.ShowDetail=u;i=function(){function n(n){this.content="";this.content=n.innerHTML==null?n.innerText:n.innerHTML}return n.prototype.applyTemplate=function(n){n.innerHTML=this.content!=null?this.content:""},n}();t.Template=i;f=function(){function t(n,t){this.columns=[];this.batchSize=5;this.firstLoadSize=10;this.currentPage=0;this.groupBySortDescriptors=[];this.filterDescriptors=[];this.selection=[];this.target=n;this.framework=t;this.initialize()}return t.prototype.isSelected=function(n){for(var t=0;t<this.selection.length;t++)if(this.selection[t]==n)return!0;return!1},t.prototype.initialize=function(){var b=this.target.getElementsByTagName("script")[0].innerHTML,o=document.createElement("div"),t,c,l,a,v,y,s;o.innerHTML=b;var k=o.getElementsByTagName("header"),d=o.getElementsByTagName("cell"),g=o.getElementsByTagName("celldetail"),f=o.getElementsByTagName("column");for(t=0;t<f.length;t++){var h=$(f[t]),p=h.find("header"),w=h.find("cell"),e=new r;e.member=f[t].attributes["data-g-member"]!=undefined?f[t].attributes["data-g-member"].nodeValue:null;e.header=p.length>0?new i(p[0]):null;e.cell=w.length>0?new i(w[0]):null;c=h.find("celldetail");e.cellDetail=c.length==1?new i(c[0]):null;e.sortMemberPath=f[t].attributes["data-g-sort-member"]!=undefined?f[t].attributes["data-g-sort-member"].nodeValue:e.member;e.groupMemberPath=f[t].attributes["data-g-group-member"]!==undefined?f[t].attributes["data-g-group-member"].nodeValue:e.member;e.width=f[t].attributes["data-g-width"]!=null?f[t].attributes["data-g-width"].nodeValue:100;e.device=f[t].attributes["data-g-views"]!=null?f[t].attributes["data-g-views"].nodeValue:"mobile,desktop";e.resizable=f[t].attributes["data-g-resizable"]!=undefined?f[t].attributes["data-g-resizable"].nodeValue=="false"?!1:!0:!0;e.filterMemberPath=f[t].attributes["data-g-filter-member"]!=undefined?f[t].attributes["data-g-filter-member"].nodeValue:e.member;this.columns.push(e)}this.sortDescriptor=new n.TGrid.SortDescriptor(null,null);l=o.getElementsByTagName("filterpopup");this.filterPopup=l.length==1?new i(l[0]):null;a=o.getElementsByTagName("mobile");this.mobileTemplateHtml=a.length==1?new i(a[0]):null;v=o.getElementsByTagName("groupheader");this.groupHeaderTemplate=v.length==1?new i(v[0]):null;y=o.getElementsByTagName("details");this.detailsTemplateHtml=y.length==1?new i(y[0]):null;this.showDetailFor=new u;s=o.getElementsByTagName("footer");this.tableFooterTemplate=s.length>0?new i(s[0]):null;this.tableFooterTemplate=s.length!=0?new i(s[0]):null},t}();t.Options=f})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={})),function(n){(function(n){var t=function(){function n(n,t){this.path=n;this.asc=t}return n}();n.SortDescriptor=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={})),function(n){(function(n){var t=function(){function t(n,t,i){var o=this,s,u,f,r,e;for(this.isPreloadingNext=!1,this.isPreloadingPrevious=!1,this.enablePreload=!0,n.grid=this,this.targetElement=n,this.options=t,this.collapsedFilterGroup=[],s=0;s<this.options.columns.length;s++)this.collapsedFilterGroup.push([]);this.itemProvider=i;this.htmlProvider=this.getHtmlProvider(this.options);this.footerViewModel=this.htmlProvider.getFooterViewModel();this.rootElement=document.createElement("div");this.rootElement.className="tgrid-root";this.groupByElement=document.createElement("div");this.groupByElement.className="tgrid-group-by-panel desktop";this.rootElement.appendChild(this.groupByElement);this.headerContainer=document.createElement("div");this.headerContainer.className="tgrid-tableheadercontainer desktop";u=document.createElement("table");u.className="tgrid-table";this.headerContainer.appendChild(u);this.options.enableFiltering&&(this.filterPopUp=document.createElement("div"),this.filterPopUp.setAttribute("class","tgrid-filter-popup"),this.filterPopUp.style.display="none",this.targetElement.appendChild(this.filterPopUp),this.filterPopupViewModel=this.htmlProvider.getFilterPopupViewModel(this.filterPopUp),this.htmlProvider.updateFilteringPopUp(this.options,this.filterPopUp,this.filterPopupViewModel));this.mobileHeader=document.createElement("div");this.mobileHeader.className="tgrid-mobile-header mobile";this.rootElement.appendChild(this.mobileHeader);this.tableHeader=document.createElement("thead");this.tableHeader.setAttribute("class","tgrid-table-header desktop");u.appendChild(this.tableHeader);this.rootElement.appendChild(this.headerContainer);this.tableBodyContainer=document.createElement("div");this.tableBodyContainer.className="tgrid-tablebodycontainer desktop";t.enableVirtualScroll?this.tableBodyContainer.onscroll=function(){return o.scrollTable()}:this.itemProvider.getTotalItemsCount(t.filterDescriptors,function(n){o.options.firstLoadSize=n});f=document.createElement("table");f.className="tgrid-table";this.tableBodyContainer.appendChild(f);this.tableBody=document.createElement("tbody");f.appendChild(this.tableBody);t.enableVirtualScroll?(r=document.createElement("div"),r.style.position="relative",this.scrollBar=document.createElement("div"),this.scrollBar.className="tgrid-scroll",this.scrollBar.style.position="absolute",this.scrollBar.style.right="0px",this.scrollBar.style.top="0px",this.scrollBar.style.bottom="0px",this.scrollBar.style.overflowX="hidden",this.scrollBar.style.overflowY="scroll",e=document.createElement("div"),e.style.height="10000px",e.style.width="1px",this.scrollBar.appendChild(e),r.appendChild(this.scrollBar),r.appendChild(this.tableBodyContainer),this.rootElement.appendChild(r),this.scrollBar.onscroll=function(){return o.onManualScroll()}):this.rootElement.appendChild(this.tableBodyContainer);this.mobileContainer=document.createElement("div");this.mobileContainer.setAttribute("class","tgrid-mobile-container mobile");this.rootElement.appendChild(this.mobileContainer);this.tableFooter=document.createElement("div");this.tableFooter.setAttribute("class","tgrid-footer");this.rootElement.appendChild(this.tableFooter);this.targetElement.appendChild(this.rootElement);this.tableBodyContainer.scrollTop=0;this.options.groupBySortDescriptors.length>0?(this.refreshHeader(),this.refreshBody(t.enableVirtualScroll)):this.sortBy(this.options.sortDescriptor.path);this.refreshFooter();this.buisyIndicator=document.createElement("div");this.buisyIndicator.className="tgrid-buisy-indicator";this.rootElement.appendChild(this.buisyIndicator);this.hideBuisyIndicator()}return t.getGridObject=function(n){return n.grid==undefined||n.grid==null?n.parentElement==document.body?null:t.getGridObject(n.parentElement):n.grid},t.prototype.columnsResized=function(n){parseInt(n.width)<5&&(n.width="5");this.htmlProvider.updateColumnWidth(this.options,this.tableHeader,this.tableBody,this.tableFooter)},t.prototype.getPreviousPageFirsItemIndex=function(){var n=this.firstVisibleItemIndex-this.options.batchSize;return n<0&&(n=0),n},t.prototype.getPreviousPageSize=function(){var n=this.options.batchSize,t=this.firstVisibleItemIndex-n;return t<0?n+t:n},t.prototype.getNextPageFirstItemIndex=function(){return this.firstVisibleItemIndex+this.visibleItems.length},t.prototype.getNextPageSize=function(){return this.options.batchSize},t.prototype.getEffectiveSorting=function(){for(var r,i,t=[],u=!1,n=0;n<this.options.groupBySortDescriptors.length;n++){for(r=!1,i=0;i<t.length;i++)if(this.options.sortDescriptor.path==this.options.groupBySortDescriptors[n].path&&(u=!0),t[i].path==this.options.groupBySortDescriptors[n].path){r=!0;break}r||(this.options.groupBySortDescriptors[n].path==this.options.sortDescriptor.path&&(this.options.groupBySortDescriptors[n].asc=this.options.sortDescriptor.asc),t.push(this.options.groupBySortDescriptors[n]))}return u||t.push(this.options.sortDescriptor),t},t.prototype.getEffectiveFiltering=function(){var n=[];return(this.options.filterDescriptors!=null||this.options.filterDescriptors.length>0)&&(n=n.concat(this.options.filterDescriptors)),n},t.prototype.getCollapsedGroupFilter=function(){for(var t=[],n=0;n<this.collapsedFilterGroup.length;n++)(this.collapsedFilterGroup[n]!=null||this.collapsedFilterGroup[n].length>0)&&(t=t.concat(this.collapsedFilterGroup[n]));return t},t.prototype.scrollTable=function(){var n=this;setTimeout(function(){!n.isPreloadingNext&&n.enablePreload&&n.tableBodyContainer.scrollTop>(n.tableBodyContainer.scrollHeight-n.tableBodyContainer.clientHeight)/4*3&&n.nextPage==null&&n.preloadNextPage();!n.isPreloadingPrevious&&n.enablePreload&&n.tableBodyContainer.scrollTop<(n.tableBodyContainer.scrollHeight-n.tableBodyContainer.clientHeight)/4&&n.previousPage==null&&n.preloadPreviousPage();n.totalItemsCount>n.firstVisibleItemIndex+n.visibleItems.length&&n.tableBodyContainer.scrollTop+n.tableBodyContainer.clientHeight>=n.tableBodyContainer.scrollHeight&&n.showNextPage();n.firstVisibleItemIndex>0&&n.tableBodyContainer.scrollTop==0&&n.showPreviousPage();n.updateGlobalScroll()},1)},t.prototype.updateGlobalScroll=function(){var i=this,r=this.htmlProvider.getFirstVisibleItem(this.tableBody,this.visibleViewModels,this.tableBodyContainer.scrollTop),t,n,u,f;if(r!=null){for(t=this.firstVisibleItemIndex,n=0;n<this.visibleItems.length;n++)if(r.item==this.visibleItems[n]){t=this.firstVisibleItemIndex+n;break}this.scrollBar.onscroll=null;u=this.htmlProvider.getVisibleitemsCount(this.tableBody,this.tableBodyContainer,this.visibleViewModels,this.tableBodyContainer.scrollTop);f=(this.scrollBar.scrollHeight-this.scrollBar.clientHeight)/(this.totalItemsCount-u)*t;this.scrollBar.onscroll=function(){i.scrollBar.onscroll=function(){return i.onManualScroll()}};this.scrollBar.scrollTop=f}},t.prototype.onManualScroll=function(){var n=this,r=this.htmlProvider.getVisibleitemsCount(this.tableBody,this.tableBodyContainer,this.visibleViewModels,this.tableBodyContainer.scrollTop),u=(this.scrollBar.scrollHeight-this.scrollBar.clientHeight)/(this.totalItemsCount-r),t=this.scrollBar.scrollTop/u,i;this.showBuisyIndicator();this.previousPage=null;this.nextPage=null;i=!1;t+this.options.firstLoadSize>this.totalItemsCount&&(t=this.totalItemsCount-this.options.firstLoadSize,i=!0);this.itemProvider.getItems(t,this.options.firstLoadSize,this.getEffectiveSorting(),this.getEffectiveFiltering(),this.getCollapsedGroupFilter(),function(r,u){t==0?n.scrollTableContainer(0):n.scrollTableContainer(48);n.firstVisibleItemIndex=u;n.visibleItems=r;n.visibleViewModels=n.buildViewModels(n.visibleItems);n.updateVisibleItems();n.hideBuisyIndicator();i&&n.silentScrollTableContainer(n.tableBody.clientHeight-n.tableBodyContainer.clientHeight)})},t.prototype.preloadPreviousPage=function(){var n=this,t=this.getPreviousPageSize();t>0&&(this.isPreloadingPrevious=!0,this.itemProvider.getItems(this.getPreviousPageFirsItemIndex(),t,this.getEffectiveSorting(),this.getEffectiveFiltering(),this.getCollapsedGroupFilter(),function(t){n.previousPage=t;n.isPreloadingPrevious=!1}))},t.prototype.preloadNextPage=function(){var n=this;this.isPreloadingNext=!0;this.itemProvider.getItems(this.getNextPageFirstItemIndex(),this.getNextPageSize(),this.getEffectiveSorting(),this.getEffectiveFiltering(),this.getCollapsedGroupFilter(),function(t){n.nextPage=t;n.isPreloadingNext=!1})},t.prototype.showPreviousPage=function(){var u=this,i,t,n,r;if(this.previousPage==null){if(this.firstVisibleItemIndex==0){this.hideBuisyIndicator();return}this.showBuisyIndicator();this.isPreloadingPrevious||this.preloadPreviousPage();setTimeout(function(){u.showPreviousPage()},10)}else if(this.previousPage!=null&&this.previousPage.length>0){for(this.hideBuisyIndicator(),this.enablePreload=!1,this.visibleItems.splice(this.visibleItems.length-this.options.batchSize,this.options.batchSize),this.firstVisibleItemIndex-=this.options.batchSize,this.firstVisibleItemIndex<0&&(this.firstVisibleItemIndex=0),i=this.previousPage[this.previousPage.length-1],this.visibleItems=this.previousPage.concat(this.visibleItems),this.visibleViewModels=this.buildViewModels(this.visibleItems),this.updateVisibleItems(),t=[],n=0;n<this.visibleViewModels.length-1;n++)if(t.push(this.visibleViewModels[n]),this.visibleViewModels[n].item==i){t.push(this.visibleViewModels[n+1]);break}r=this.htmlProvider.getElemntsSize(this.tableBody,t);this.scrollTableContainer(r);this.previousPage=null;this.nextPage=null;this.enablePreload=!0}},t.prototype.showNextPage=function(){var o=this,t,r,i,u,f,n,e;if(this.nextPage==null){if(this.totalItemsCount<=this.firstVisibleItemIndex+this.visibleItems.length){this.hideBuisyIndicator();return}this.showBuisyIndicator();this.isPreloadingNext||this.preloadNextPage();setTimeout(function(){o.showNextPage()},10)}else if(this.nextPage!=null&&this.nextPage.length>0){for(this.hideBuisyIndicator(),this.enablePreload=!1,t=this.htmlProvider.getFirstVisibleItem(this.tableBody,this.visibleViewModels,this.tableBodyContainer.scrollTop),r=0,n=0;n<this.visibleItems.length;n++)if(t.item==this.visibleItems[n]){r=n;break}for(i=r-this.options.batchSize,i>0&&(this.visibleItems.splice(0,i),this.firstVisibleItemIndex+=i),u=t,n=0;n<this.visibleItems.length-1;n++)if(t.item==this.visibleItems[n]){u=this.visibleItems[n+1];break}for(this.visibleItems=this.visibleItems.concat(this.nextPage),this.visibleViewModels=this.buildViewModels(this.visibleItems),this.updateVisibleItems(),f=[],n=0;n<this.visibleViewModels.length;n++)if(f.push(this.visibleViewModels[n]),this.visibleViewModels[n].item==u)break;e=this.htmlProvider.getElemntsSize(this.tableBody,f);this.scrollTableContainer(e);this.nextPage=null;this.previousPage=null;this.enablePreload=!0}},t.prototype.scrollTableContainer=function(n){this.tableBodyContainer.scrollTop=n},t.prototype.silentScrollTableContainer=function(n){var t=this;this.tableBodyContainer.onscroll=null;this.tableBodyContainer.scrollTop=n;setTimeout(function(){t.tableBodyContainer.onscroll=function(){return t.scrollTable()}},10)},t.prototype.addGroupDescriptor=function(t,i){this.options.groupBySortDescriptors.push(new n.SortDescriptor(t,i));this.refreshHeader();this.refreshBody()},t.prototype.toggleGroupDescriptor=function(n){for(var t=0;t<this.options.groupBySortDescriptors.length;t++)if(this.options.groupBySortDescriptors[t].path==n){this.removeGroupDescriptor(n);return}this.addGroupDescriptor(n,!0)},t.prototype.removeGroupDescriptor=function(n){for(var t=0;t<this.options.groupBySortDescriptors.length;t++)this.options.groupBySortDescriptors[t].path==n&&this.options.groupBySortDescriptors.splice(t,1);this.refreshHeader();this.refreshBody()},t.prototype.showFilterPopup=function(n,t,i,r){this.filterPopupViewModel.onOpen(this.options,n);r&&(this.filterPopUp.style.left=t.toString()+"px",this.filterPopUp.style.top=i.toString()+"px");unhideElement(this.filterPopUp)},t.prototype.hideFilterPopup=function(){hideElement(this.filterPopUp)},t.prototype.setFilter=function(n,t){for(var i=0;i<this.options.filterDescriptors.length;i++)this.options.filterDescriptors[i].path==n.filterMemberPath&&this.options.filterDescriptors.splice(i,1);this.options.filterDescriptors.push(t);this.refreshBody()},t.prototype.clearFilter=function(n){for(var t=0;t<this.options.filterDescriptors.length;t++)this.options.filterDescriptors[t].path==n.filterMemberPath&&this.options.filterDescriptors.splice(t,1);this.refreshBody()},t.prototype.sortBy=function(n){n!=null&&(n==this.options.sortDescriptor.path?this.options.sortDescriptor.asc?this.options.sortDescriptor.asc=!this.options.sortDescriptor.asc:(this.options.sortDescriptor.path=null,this.options.sortDescriptor.asc=null):(this.options.sortDescriptor.path=n,this.options.sortDescriptor.asc=!0));this.refreshHeader();this.refreshBody()},t.prototype.mobileSortBy=function(t,i){i!=null?(this.options.sortDescriptor.path=t,this.options.sortDescriptor.asc=i):this.options.sortDescriptor=new n.SortDescriptor(null,null);this.refreshHeader();this.refreshBody()},t.prototype.selectPage=function(n){this.options.currentPage=n;this.refreshHeader();this.refreshBody();this.refreshFooter()},t.prototype.selectItem=function(t,i){for(var u=[],r=0;r<this.options.selection.length;r++)u.push(this.options.selection[r]);for(this.options.selectionMode==n.SelectionMode.Multi?i?this.options.isSelected(t.item)?this.options.selection.splice(r,1):this.options.selection.push(t.item):this.options.selection=[t.item]:this.options.selection=this.options.selectionMode==n.SelectionMode.Single?[t.item]:[],this.options.openDetailsOnSelection&&(this.options.selection.length==1?(this.options.showDetailFor=new n.ShowDetail,this.options.showDetailFor.item=this.options.selection[0]):this.options.showDetailFor=new n.ShowDetail),r=0;r<u.length;r++)this.updateRow(u[r]);for(r=0;r<this.options.selection.length;r++)this.updateRow(this.options.selection[r]);return this.updateFooterViewModel(),!0},t.prototype.updateRow=function(n){this.htmlProvider.updateTableDetailRow(this.options,this.tableBodyContainer.getElementsByTagName("tbody")[0],n);this.htmlProvider.updateMobileDetailRow(this.options,this.mobileContainer,n)},t.prototype.buildViewModels=function(t){for(var f,e,h,o,r,s=[],u=[],c=[],i=0;i<this.options.groupBySortDescriptors.length;i++)u.push(""),c.push(!1);for(f=0;f<t.length;f++){for(e=!1,i=0;i<this.options.groupBySortDescriptors.length;i++)if(h=getMemberValue(t[f],this.options.groupBySortDescriptors[i].path),u[i]!==h){for(u[i]=h,o=new n.FilterDescriptor(this.options.groupBySortDescriptors[0].path,u[0],n.FilterCondition.NotEquals),r=1;r<=i;r++)o.children.push(new n.FilterDescriptor(this.options.groupBySortDescriptors[r].path,u[r],n.FilterCondition.NotEquals));for(e=this.isFilterInCollapsed(o),s.push(new n.ItemViewModel(this.options.parentViewModel,new n.GroupHeaderDescriptor(u[i],i,e,o),this,!0)),r=i+1;r<this.options.groupBySortDescriptors.length;r++)u[r]="";e&&(i=this.options.groupBySortDescriptors.length)}e||s.push(new n.ItemViewModel(this.options.parentViewModel,t[f],this,!1))}return s},t.prototype.isFiltersEquals=function(n,t){var r,i;if(n.path==t.path&&n.value==t.value&&n.children.length<=t.children.length){for(r=0,i=0;i<n.children.length;i++)n.children[i].path==t.children[i].path&&n.children[i].value==t.children[i].value&&r++;if(r==n.children.length)return!0}return!1},t.prototype.isFilterInCollapsed=function(n){for(var t=0;t<this.collapsedFilterGroup[n.children.length].length;t++)if(this.isFiltersEquals(n,this.collapsedFilterGroup[n.children.length][t]))return!0;return!1},t.prototype.filterDescriptorToArray=function(t){var i=[];return i=i.concat(t.children),i.push(new n.FilterDescriptor(t.path,t.value,t.condition)),i},t.prototype.updateVisibleItems=function(){var n=this;this.tableBody.innerHTML="";this.htmlProvider.updateTableBodyElement(this.options,this.tableBody,this.visibleViewModels,function(t,i){return n.selectItem(t,i)});this.htmlProvider.updateColumnWidth(this.options,this.tableHeader,this.tableBody,this.tableFooter);this.mobileContainer.innerHTML="";this.htmlProvider.updateMobileItemsList(this.options,this.mobileContainer,this.visibleViewModels,function(t,i){return n.selectItem(t,i)})},t.prototype.getHtmlProvider=function(t){return t.framework==n.Framework.Knockout?new n.KnockoutHtmlProvider:t.framework==n.Framework.Angular?new n.AngularHtmlProvider:void 0},t.prototype.getFirstItemNumber=function(){return this.options.pageSize*this.options.currentPage},t.prototype.getPageSize=function(){return this.options.pageSize},t.prototype.refreshHeader=function(){var n=this;this.options.enableGrouping?unhideElement(this.groupByElement):hideElement(this.groupByElement);this.htmlProvider.updateTableHeadElement(this.options,this.tableHeader,this.groupByElement,this.filterPopUp,function(t){return n.columnsResized(t)});this.refreshMobileHeader()},t.prototype.updateBody=function(){this.refreshBody()},t.prototype.refreshBody=function(n){typeof n=="undefined"&&(n=!1);var t=this;n&&this.showBuisyIndicator();this.options.enablePaging?this.itemProvider.getTotalItemsCount(this.getEffectiveFiltering(),function(i){t.totalItemsCount=i;t.itemProvider.getItems(t.getFirstItemNumber(),t.getPageSize(),t.getEffectiveSorting(),t.getEffectiveFiltering(),t.getCollapsedGroupFilter(),function(i,r){t.firstVisibleItemIndex=r;t.visibleItems=i;t.visibleViewModels=t.buildViewModels(t.visibleItems);t.updateVisibleItems();t.updateFooterViewModel();n&&t.hideBuisyIndicator()})}):this.itemProvider.getTotalItemsCount(this.getEffectiveFiltering(),function(i){t.totalItemsCount=i;t.itemProvider.getItems(t.getFirstItemNumber(),t.options.firstLoadSize,t.getEffectiveSorting(),t.getEffectiveFiltering(),t.getCollapsedGroupFilter(),function(i,r){t.firstVisibleItemIndex=r;t.visibleItems=i;t.visibleViewModels=t.buildViewModels(t.visibleItems);t.updateVisibleItems();t.updateFooterViewModel();n&&(t.hideBuisyIndicator(),t.htmlProvider.getElemntsSize(t.tableBody,null)<t.tableBodyContainer.clientHeight+100&&(t.options.firstLoadSize*=2,t.refreshBody()))})})},t.prototype.refreshFooter=function(){this.tableFooter.innerHTML="";this.htmlProvider.updateTableFooterElement(this.options,this.tableFooter,this.totalItemsCount,this.footerViewModel)},t.prototype.updateFooterViewModel=function(){this.footerViewModel!=null&&(this.footerViewModel.setCurrentPage(this.options.currentPage+1),this.footerViewModel.setSelectedItem(this.options.selection[0]),this.footerViewModel.setTotalCount(this.totalItemsCount),this.options.enablePaging?this.footerViewModel.setTotalPages(Math.ceil(this.totalItemsCount/this.options.pageSize)):this.footerViewModel.setTotalPages(1))},t.prototype.showBuisyIndicator=function(){this.buisyIndicator.removeAttribute("style")},t.prototype.hideBuisyIndicator=function(){this.buisyIndicator.setAttribute("style","display: none;")},t.prototype.setCollapsedFilters=function(n){this.collapsedFilterGroup[n.children.length].push(n);this.refreshBody()},t.prototype.removeCollapsedFilters=function(n){for(var t=0;t<this.collapsedFilterGroup[n.children.length].length;t++)this.isFiltersEquals(this.collapsedFilterGroup[n.children.length][t],n)&&this.collapsedFilterGroup[n.children.length].splice(t,1);this.refreshBody()},t.prototype.setFilters=function(n,t){this.removeFilters(t,!1);this.options.filterDescriptors.push(n);this.refreshMobileHeader();this.refreshBody()},t.prototype.removeFilters=function(n,t){typeof t=="undefined"&&(t=!0);for(var i=0;i<this.options.filterDescriptors.length;i++)this.options.filterDescriptors[i].path==n&&this.options.filterDescriptors.splice(i,1);t&&(this.refreshMobileHeader(),this.refreshBody())},t.prototype.refreshMobileHeader=function(){this.htmlProvider.updateMobileHeadElement(this.options,this.mobileHeader,this.filterPopUp)},t.prototype.setDefaultFilterPopUpValues=function(){for(var t=0;t<this.filterPopUp.getElementsByTagName("input").length;t++)this.filterPopUp.getElementsByTagName("input")[t].type=="text"&&(this.filterPopUp.getElementsByTagName("input")[t].value="");for(t=0;t<this.filterPopUp.getElementsByTagName("select").length;t++)this.filterPopUp.getElementsByTagName("select")[t].selectedIndex=n.FilterCondition.None},t}();n.Grid=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={}))