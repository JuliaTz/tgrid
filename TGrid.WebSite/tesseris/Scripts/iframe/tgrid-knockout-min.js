var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},TGridBindingHandler,TesserisPro;(function(n){(function(t){var i=function(i){function r(){i.apply(this,arguments)}return __extends(r,i),r.prototype.getTableElement=function(){var n=document.createElement("table");return n.className="tgrid-table",n},r.prototype.getElemntsSize=function(n,t){for(var r,u,f=0,e=n.children,i=0;i<e.length;i++)r=e.item(i),u=ko.contextFor(r).$root,u!=null&&t.indexOf(u)>0&&(f+=r.clientHeight);return f},r.prototype.getFirstVisibleItem=function(n,t,i){for(var f,r,e=0,o=n.children,u=0;u<o.length;u++)if(f=o.item(u),r=ko.contextFor(f).$root,r!=null&&t.indexOf(r)>0&&(e+=f.clientHeight),e>i)return r;return null},r.prototype.getFooterViewModel=function(){return new t.KnockoutFooterViewModel(0,0,0,0)},r.prototype.getFilterPopupViewModel=function(n){return new t.KnockoutFilterPopupViewModel(n)},r.prototype.updateTableHeadElement=function(n,i,r,u,f,e){var p,y,s,o,h,l,a,c,b,v,w;if(i.innerHTML!=null&&i.innerHTML!=""){if(this.showNeededIntends(i,n.groupBySortDescriptor.length,t.Grid.getGridObject(i)),f)for(this.removeArrows(i),p=i.getElementsByTagName("th"),o=n.columns.length,y=0;o<p.length,y<n.columns.length;o++,y++)n.sortDescriptor.path==n.columns[y].sortMemberPath&&this.addArrows(p[o].getElementsByClassName("tgrid-header-cell-buttons")[0],n,o);this.updateGroupByElements(n,i,r)}else{for(this.addGroupBy(n,i,r),s=document.createElement("tr"),this.appendIndent(s,n.columns.length,!0),this.showNeededIntends(s,n.groupBySortDescriptor.length,t.Grid.getGridObject(i)),o=0;o<n.columns.length;o++)h=document.createElement("th"),h.className="tgrid-header-cell",l=document.createElement("div"),l.className="tgrid-header-cell-container",a=document.createElement("div"),c=document.createElement("div"),a.className="tgrid-header-cell-content",c.className="tgrid-header-cell-buttons",l.appendChild(a),l.appendChild(c),h.appendChild(l),h.setAttribute("width",n.columns[o].width),n.columns[o].header!=null?n.columns[o].header.applyTemplate(a):(b=n.columns[o].member!=null?n.columns[o].member:"",this.createDefaultHeader(a,b)),function(i){h.onclick=function(r){return t.Grid.getGridObject(r.target).sortBy(n.columns[i].sortMemberPath)}}(o),f&&n.sortDescriptor.path==n.columns[o].sortMemberPath&&this.addArrows(c,n,o),this.addFilterButton(n,i,u,c,o),n.columns[o].resizable&&(v=document.createElement("div"),v.className="tgrid-header-column-resize",v.onclick=function(n){return n.stopImmediatePropagation()},function(t,i,r){var f=null,u=0;r.onmousedown=function(i){i.stopImmediatePropagation();console.log("test");u=i.screenX;f=document.onmousemove;document.onmousemove=function(i){u!=0&&(n.columns[t].width=(parseInt(n.columns[t].width)+i.screenX-u).toString(),u=i.screenX,e(n.columns[t]))}};document.onmouseup=function(){document.onmousemove=f;u=0}}(o,h,v),c.appendChild(v)),s.appendChild(h);w=document.createElement("th");w.classList.add("tgrid-placeholder");s.appendChild(w);i.appendChild(s);ko.applyBindings(n.parentViewModel,s)}},r.prototype.updateTableBodyElement=function(n,t,i,r){var f,u;for(n.showDetailFor.isDetailColumn||(n.showDetailFor.column=-1),f=0;f<i.length;f++)this.appendTableElement(n,t,i[f],0,r);u=t.getAttribute("class");u==null||u==undefined||u==""?u="desktop":u.indexOf("desktop")==-1&&(u+=" desktop");t.classList.add(u)},r.prototype.updateTableDetailRow=function(n,i,r){var e=i.getElementsByClassName("details"),u,o,f;if(e.length>0&&e[0].parentNode.removeChild(e[0]),n.selectionMode==t.SelectionMode.Multi){if(!n.ctrlKey)for(u=0;u<i.children.length;u++)i.children.item(u).classList.remove("selected");n.isSelected(r)?n.selectedRow.classList.add("selected"):n.selectedRow.classList.remove("selected")}if(n.selectionMode==t.SelectionMode.Single){for(u=0;u<i.children.length;u++)i.children.item(u).classList.remove("selected");n.isSelected(r)?n.selectedRow.classList.add("selected"):n.selectedRow.classList.remove("selected")}o=i.getElementsByClassName("selected");this.hasDetails(o,n)&&(f=this.buildDetailsRow(n),f.classList.add("details"),insertAfter(o[0],f),ko.applyBindings(n.showDetailFor,f))},r.prototype.updateTableFooterElement=function(n,t,i,r){if(n.tableFooterTemplate==null&&n.isEnablePaging)this.updateTableFooterElementDefault(n,t,i);else if(n.tableFooterTemplate!=null){var u=document.createElement("div");n.isEnablePaging&&this.updateTableFooterElementDefault(n,t,i);n.tableFooterTemplate.applyTemplate(u);ko.applyBindings(r,u);t.appendChild(u)}},r.prototype.addFilteringPopUp=function(n,t,i){if(n.filterPopup==null)this.defaultFiltringPopUp(n,t);else{var r=document.createElement("div");r.className="tgrid-filter-popup-container";n.filterPopup.applyTemplate(r);t.innerHTML="";t.appendChild(r);ko.applyBindings(i,t)}},r.prototype.appendTableElement=function(n,t,i,r,u){var f,e;i.isGroupHeader?(f=this.buildGroupHeaderRow(n,i.item),t.appendChild(f),ko.applyBindings(i,f)):(e=this.buildRowElement(n,i,t,u),t.appendChild(e),ko.applyBindings(i,e))},r.prototype.upadeteTableColumnsWidth=function(){},r.prototype.buildRowElement=function(n,i,r,u){var f=document.createElement("tr"),e,o,s;for(f.classList.add("table-body-row"),n.isSelected(i.item)&&f.classList.add("selected"),this.appendIndent(f,n.groupBySortDescriptor.length,!1),e=0;e<n.columns.length;e++)o=document.createElement("td"),n.columns[e].cell!=null?n.columns[e].cell.applyTemplate(o):n.columns[e].member!=null&&(o=this.createDefaultCell(o,n.columns[e].member)),f.appendChild(o);return s=document.createElement("td"),s.classList.add("tgrid-placeholder"),f.appendChild(s),function(i){f.onclick=function(r){n.selectionMode!=t.SelectionMode.None&&(n.ctrlKey=r.ctrlKey,n.selectedRow=this,u(i,r.ctrlKey))}}(i),f},r.prototype.buildDetailsRow=function(n){var t=document.createElement("tr"),i=document.createElement("td");return this.appendIndent(t,n.groupBySortDescriptor.length,!1),t.classList.add("details"),i.setAttribute("colspan",(n.columns.length+1).toString()),n.showDetailFor.column==-1?n.detailsTemplateHtml.applyTemplate(i):n.columns[n.showDetailFor.column].cellDetail.applyTemplate(i),t.appendChild(i),t},r.prototype.buildGroupHeaderRow=function(t,i){var u=document.createElement("tr"),r=document.createElement("td"),f;return this.appendIndent(u,i.level,!1),f=t.columns.length+1+t.groupBySortDescriptor.length-i.level,r.setAttribute("colspan",f.toString()),r.classList.add("tgrid-table-group-header"),u.classList.add("tgrid-table-group-header"),t.isEnableCollapsing&&(r.onclick=i.collapse?function(t){n.TGrid.Grid.getGridObject(t.target).removeCollapsedFilters(i.filterDescriptor)}:function(t){n.TGrid.Grid.getGridObject(t.target).setCollapsedFilters(i.filterDescriptor)}),t.groupHeaderTemplate!=null?t.groupHeaderTemplate.applyTemplate(r):r=this.createDefaultGroupHeader(r),u.appendChild(r),u},r.prototype.addArrows=function(n,t){var i,r;return t.sortDescriptor.asc&&(i=document.createElement("div"),i.classList.add("tgrid-arrow-up"),n.appendChild(i)),t.sortDescriptor.asc||(r=document.createElement("div"),r.classList.add("tgrid-arrow-down"),n.appendChild(r)),n},r.prototype.removeArrows=function(n){var t=n.getElementsByClassName("tgrid-arrow-up");t.length==1&&t[0].parentNode.removeChild(t[0]);t=n.getElementsByClassName("tgrid-arrow-down");t.length==1&&t[0].parentNode.removeChild(t[0])},r.prototype.appendIndent=function(n,t,i){for(var r,f=i?"th":"td",u=0;u<t;u++)r=document.createElement(f),r.className="tgrid-table-indent-cell",n.appendChild(r)},r.prototype.updateMobileItemsList=function(n,t,i,r){var f,u;for(n.showDetailFor.isDetailColumn||(n.showDetailFor.column=-1),f=0;f<i.length;f++)this.appendMobileElement(n,t,i[f],0,r);u=t.getAttribute("class");u==null||u==undefined||u==""?u="mobile":u.indexOf("mobile")==-1&&(u+=" mobile");t.setAttribute("class",u);n.showDetailFor.isDetailColumn=!1},r.prototype.updateMobileDetailRow=function(n,i,r){var e=i.getElementsByClassName("details"),u,o,f;if(e.length>0&&e[0].parentNode.removeChild(e[0]),n.selectionMode==t.SelectionMode.Multi){if(!n.ctrlKey)for(u=0;u<i.children.length;u++)i.children.item(u).classList.remove("selected");n.isSelected(r.item)?n.selectedRow.classList.add("selected"):i.children.item(u).classList.remove("selected")}if(n.selectionMode==t.SelectionMode.Single){for(u=0;u<i.children.length;u++)i.children.item(u).classList.remove("selected");n.isSelected(r)?n.selectedRow.classList.add("selected"):i.children.item(u).classList.remove("selected")}o=i.getElementsByClassName("selected");this.hasDetails(o,n)&&(f=this.buildMobileDetailsRow(n),f.classList.add("details"),insertAfter(o[0],f),ko.applyBindings(n.showDetailFor,f))},r.prototype.appendMobileElement=function(n,t,i,r,u){var f,e;i.isGroupHeader&&n.groupHeaderTemplate!=null?(f=this.buildGroupMobileHeaderRow(n,i.item),t.appendChild(f),ko.applyBindings(i,f)):(e=this.buildMobileRowElement(n,i,t,u),t.appendChild(e),ko.applyBindings(i,e))},r.prototype.buildMobileRowElement=function(n,i,r,u){var f=document.createElement("div"),o,e,s;for(f.classList.add("tgrid-mobile-row"),n.isSelected(i.item)&&f.classList.add("selected"),o=0;o<n.groupBySortDescriptor.length;o++)f.innerHTML+="<div class='tgrid-mobile-indent-div'><\/div>";return e=document.createElement("div"),e.classList.add("tgrid-mobile-div"),n.mobileTemplateHtml!=null?n.mobileTemplateHtml.applyTemplate(e):e=this.createDefaultMobileTemplate(e,n),f.appendChild(e),s=document.createElement("td"),s.classList.add("tgrid-placeholder"),f.appendChild(s),function(i){f.onclick=function(f){if(n.selectionMode!=t.SelectionMode.None){n.ctrlKey=f.ctrlKey;n.selectedRow=this;var e=r;u(i,f.ctrlKey)}}}(i),f},r.prototype.buildMobileDetailsRow=function(n){var t=document.createElement("div");return t.classList.add("tgrid-mobile-details"),n.showDetailFor.column==-1?n.detailsTemplateHtml.applyTemplate(t):n.columns[n.showDetailFor.column].cellDetail.applyTemplate(t),t},r.prototype.createDefaultCell=function(n,t){var i=document.createElement("span"),r="text: item.".concat(t);return i.setAttribute("data-bind",r),n.appendChild(i),n},r.prototype.createDefaultGroupHeader=function(n){var i=document.createElement("div"),t=document.createElement("span");return t.setAttribute("data-bind","text: item.value"),t.setAttribute("style","color: green;"),i.appendChild(t),n.appendChild(i),n},r.prototype.bindData=function(n,t){var i=ko.contextFor(n.target);ko.applyBindings(i,t)},r}(t.BaseHtmlProvider);t.KnockoutHtmlProvider=i})(n.TGrid||(n.TGrid={}));var t=n.TGrid})(TesserisPro||(TesserisPro={}));TGridBindingHandler=function(){function n(){}return n.prototype.init=function(t,i,r,u,f){var e=n.getOptions(t,i,r,u,f);setTimeout(function(){var n=new TesserisPro.TGrid.Grid(t,e,i().provider)},1)},n.prototype.update=function(t,i,r,u,f){var e=TesserisPro.TGrid.Grid.getGridObject(t),o;e!=null&&(o=n.getOptions(t,i,r,u,f),e.options=o,e.updateBody())},n.getOptions=function(n,t,i,r){var u=new TesserisPro.TGrid.Options(n,TesserisPro.TGrid.Framework.Knockout),f,e;if(u.parentViewModel=r,f="",f=isObservable(t().groupBy)?t().groupBy():t().groupBy,f!=undefined)for(e=0;e<f.length;e++)u.groupBySortDescriptor.push(new TesserisPro.TGrid.SortDescriptor(f[e],!0));return u.isEnablePaging=isObservable(t().enablePaging)?typeof t().enablePaging()=="boolean"?t().enablePaging():t().enablePaging=="true"?!0:!1:typeof t().enablePaging=="boolean"?t().enablePaging:t().enablePaging=="true"?!0:!1,u.pageSize=isObservable(t().pageSize)?t().pageSize():t().pageSize,u.pageSize=isNaN(u.pageSize)||u.pageSize<1?10:u.pageSize,u.selectionMode=isObservable(t().selectMode)?t().selectMode():t().selectMode,isNaN(u.selectionMode)&&(u.selectionMode=1),u.isEnableVirtualScroll=isObservable(t().enableVirtualScroll)?typeof t().enableVirtualScroll()=="boolean"?t().enableVirtualScroll():t().enableVirtualScroll=="true"?!0:!1:typeof t().enableVirtualScroll=="boolean"?t().enableVirtualScroll:t().enableVirtualScroll=="true"?!0:!1,u.isEnableCollapsing=isObservable(t().enableCollapsing)?typeof t().enableCollapsing()=="boolean"?t().enableCollapsing():t().enableCollapsing=="true"?!0:!1:typeof t().enableCollapsing=="boolean"?t().enableCollapsing:t().enableCollapsing=="true"?!0:!1,u.isEnableGrouping=isObservable(t().enableGrouping)?typeof t().enableGrouping()=="boolean"?t().enableGrouping():t().enableGrouping=="true"?!0:!1:typeof t().enableGrouping=="boolean"?t().enableGrouping:t().enableGrouping=="true"?!0:!1,u.isEnableFiltering=isObservable(t().enableFiltering)?typeof t().enableFiltering()=="boolean"?t().enableFiltering():t().enableFiltering=="true"?!0:!1:typeof t().enableFiltering=="boolean"?t().enableFiltering:t().enableFiltering=="true"?!0:!1,u},n}();ko.bindingHandlers.tgrid=new TGridBindingHandler,function(n){(function(n){var t=function(){function n(n,t,i,r){this.totalCount=ko.observable(n);this.selectedItem=ko.observable(t);this.currentPage=ko.observable(i);this.totalPages=ko.observable(r)}return n.prototype.setTotalCount=function(n){this.totalCount(n)},n.prototype.setSelectedItem=function(n){this.selectedItem(n)},n.prototype.setCurrentPage=function(n){this.currentPage(n)},n.prototype.setTotalPages=function(n){this.totalPages(n)},n}();n.KnockoutFooterViewModel=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={})),function(n){(function(n){var t=function(){function t(n){this.container=n}return t.prototype.onApply=function(){var t=this.container.getElementsByTagName("select")[0].selectedIndex,i=this.container.getElementsByTagName("input")[0].value,r=n.Grid.getGridObject(this.container).options.filterPath,u=new n.FilterDescriptor(r,i,t);n.Grid.getGridObject(this.container).setFilters(u)},t.prototype.onClear=function(){n.Grid.getGridObject(this.container).removeFilters()},t.prototype.onClose=function(){n.Grid.getGridObject(this.container).hideElement(this.container)},t}();n.KnockoutFilterPopupViewModel=t})(n.TGrid||(n.TGrid={}));var t=n.TGrid}(TesserisPro||(TesserisPro={}))